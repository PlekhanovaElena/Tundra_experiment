{
    "collab_server" : "",
    "contents" : "---\ntitle: \"Plant traits\"\noutput: html_notebook\n---\n\n```{r}\nlibrary(xlsx)\nlibrary(ggplot2)\nlibrary(ggpubr)\nsource(\"./functions.R\")\n```\n\n# Canoppy traits\n\n```{r Reading the canopy sheet of plant_traits table, message=FALSE, warning=FALSE}\ncan_path <- \"/home/lena/Tundra_exp/plant_traits_DPE.xlsx\"\ncan <- read.xlsx(can_path, 3)\n\nclmn = colnames(can) %in% c(\"block\", \"plot\", \"shrub_height_cm\", \"forb_height_cm\", \"graminoid_height_cm\", \"moss_layer_thickness_cm\", \"litter_layer_thickness_cm\")\ncan = can[!is.na(can$block),clmn]\ncols = c(3:7);    \ncan[,cols] = apply(can[,cols], 2, function(x) as.numeric(as.character(x)))\ncan[,1] = factor(can[,1],levels(can[,1])[c(1,3:10,2)])\n\nrm(clmn, can_path)\n```\n\nNumber of pairs within plot that have significant differences according to Mann-Witney test\n```{r}\nn_samp = 10\ncl =  6\ntpv1 = sapply(c(0:9), function(x) wilcox.test(can[(1 + n_samp*3*x):(n_samp*3*x+5), cl], can[(1 + n_samp*3*x + 5):(n_samp*3*x+n_samp*2), cl],  exact = F)$p.value)\ntpv2 = sapply(c(0:9), function(x) wilcox.test(can[(1 + n_samp*3*x):(n_samp*3*x+n_samp), cl], can[(1 + n_samp*3*x + n_samp*2):(n_samp*3*x+n_samp*3), cl],  exact = F)$p.value)\ntpv3 = sapply(c(0:9), function(x) wilcox.test(can[(1 + n_samp*3*x + n_samp):(n_samp*3*x+n_samp*2), cl], can[(1 + n_samp*3*x + n_samp*2):(n_samp*3*x+n_samp*3), cl],  exact = F)$p.value)\nsum(c(tpv1, tpv2, tpv3) < 0.05)\n```\n\nNumber of plots that have significant differences within ones according to Kruskal-Wallis test\n```{r}\ncl =  6\nkrpv = sapply(c(0:9), function(x) kruskal.test(can[(1 + n_samp*3*x):(n_samp*3*x+n_samp), cl], can[(1 + n_samp*3*x + n_samp):(n_samp*3*x+n_samp*2), cl], can[(1 + n_samp*3*x + n_samp*2):(n_samp*3*x+n_samp*3), cl])$p.value)\nsum(krpv < 0.05)\n```\n\n## Differences within plots and between plots\n\nPlots show mean of a variable with confidence intervals\n\n```{r, message=FALSE, warning=FALSE}\nynames = colnames(can)[3:ncol(can)]\n\nplot_diff(can, ynames[1])\nplot_diff(can, ynames[2])\nplot_diff(can, ynames[3])\nplot_diff(can, ynames[4])\nplot_diff(can, ynames[5])\n\n```\n## Dry/wet\n\nMann-Witney shows significant differences between dry and lake-bed in means of \n```{r}\nmwpv = sapply(c(3,5,6), function(x) wilcox.test(can[1:150, x], can[151:300,x],  exact = F)$p.value)\ncolnames(can)[c(3,5,6)[which(mwpv < 0.05)]]\n```\n\n# Individual plant traits\n\n\n```{r Reading the individual plant traits sheet of plant_traits table, message=FALSE, warning=FALSE}\nind_path <- \"/home/lena/Tundra_exp/plant_traits_DPE.xlsx\"\nind <- read.xlsx(ind_path, 2)\n\nind = ind[!is.na(ind$block),]\nind = ind[,-12]\ncols = c(6:ncol(ind));    \nind[,cols] = apply(ind[,cols], 2, function(x) as.numeric(as.character(x)))\nind[,1] = factor(ind[,1],levels(ind[,1])[c(1,3:10,2)])\n\n\nrm(clmn, ind_path)\n```\n\n## Differences within plots and between plots\n\nPlots show mean of a variable with confidence intervals\n\n```{r, message=FALSE, warning=FALSE}\nynames = colnames(ind)[cols]\n\nplot_diff(ind, ynames[1])\nplot_diff(ind, ynames[2])\nplot_diff(ind, ynames[3])\nplot_diff(ind, ynames[4])\nplot_diff(ind, ynames[5])\nplot_diff(ind, ynames[6])\nplot_diff(ind, ynames[7])\nplot_diff(ind, ynames[8])\nplot_diff(ind, ynames[9])\nplot_diff(ind, ynames[10])\nplot_diff(ind, ynames[11])\nplot_diff(ind, ynames[12])\nplot_diff(ind, ynames[13])\n```\n\n## Dry/wet\n\nMann-Witney shows significant differences between dry and lake-bed in means of \n```{r}\nmwpv = sapply(cols, function(x) wilcox.test(ind[ind$site == \"ridge\", x], ind[ind$site == \"lakebed\", x],  exact = F)$p.value)\ncolnames(ind)[cols[which(mwpv < 0.05)]]\n```\n\nWhen you save the notebook, an HTML file containing the code and output will be saved alongside it (click the *Preview* button or press *Ctrl+Shift+K* to preview the HTML file).\n",
    "created" : 1522749255724.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3196122909",
    "id" : "2079E323",
    "lastKnownWriteTime" : 1522838283,
    "last_content_update" : 1522838283740,
    "path" : "~/Tundra_exp/R_code/Plant_traits.Rmd",
    "project_path" : "Plant_traits.Rmd",
    "properties" : {
        "chunk_output_type" : "inline",
        "tempName" : "Untitled1"
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_markdown"
}