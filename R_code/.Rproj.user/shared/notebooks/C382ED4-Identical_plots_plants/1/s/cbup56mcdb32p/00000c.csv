"0","test = sapply(c(4:ncol(ins)), function(cl) {"
"0","  # ANOVA test"
"0","  anpv = sapply(c(0:9), function(x) {"
"0","    inexes_within_block = (1 + n_samp*3*x):(n_samp*3*x+n_samp*3)"
"0","    plant.mod1 = lm(paste0(colnames(ins)[cl],"" ~ plot""), data = ins[ inexes_within_block ,])"
"0","    res = anova(plant.mod1)$`Pr(>F)`                                   # results of ANOVA"
"0","    res[2] = shapiro.test(residuals(plant.mod1))$p.value               # normality of residuals"
"0","    res[3] = bartlett.test(ins[ inexes_within_block ,cl], "
"0","                           ins$plot[ inexes_within_block ])$p.value    # homogeneity of variances"
"0","    return(res)"
"0","  })"
"0","  non_anova_blocks = which((anpv[2, ] < 0.05) | (anpv[3, ] < 0.05))    # block's numbers that do not meet"
"0","                                                                       # ANOVA's assumptions"
"0","  # Kruskal-Wallis for non-normal residuals"
"0","  krpv = sapply( non_anova_blocks , function(x) kruskal.test(ins[(1 + n_samp*3*x):(n_samp*3*x+n_samp), cl], ins[(1 +   n_samp*3*x + n_samp):(n_samp*3*x+n_samp*2), cl], ins[(1 + n_samp*3*x + n_samp*2):(n_samp*3*x+n_samp*3), cl])$p.value)"
"0","  "
"0","  # Result for ANOVA for normal residuals and Kruskal-Wallis for non-normal residuals"
"0","  n_of_sign_diff = sum(anpv[1,!non_anova_blocks] <0.05) + sum(krpv < 0.05)"
"0","  "
"0","  print(paste0(""There are significant differences within "", n_of_sign_diff, "" blocks of '"", varnames[cl-2], ""' variable""))"
"0","})"
"1","[1]"
"1"," ""There are significant differences within 0 blocks of 'Soil pH at 10cm depth' variable"""
"1","
"
"1","[1]"
"1"," ""There are significant differences within 0 blocks of 'Soil temperature, Â°C' variable"""
"1","
"
"1","[1]"
"1"," ""There are significant differences within 0 blocks of 'Active layer thickness, cm' variable"""
"1","
"
